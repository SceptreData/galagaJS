{"version":3,"sources":["js/draw.js","js/entity.js","js/main.js"],"names":["BG_COLOR","NUM_STARS","clearCanvas","canvas","ctx","width","height","clearRect","setStroke","setFill","rect","buildStars","starField","i","star","x","Math","floor","random","y","vy","ceil","push","updateStarField","stars","getContext","forEach","circle","color","strokeStyle","lineWidth","fillStyle","fill","beginPath","stroke","radius","arc","PI","closePath","image","src","w","h","drawImage","triangle","moveTo","lineTo","Draw","Entity","attrs","type","timeCreated","Date","now","position","Object","assign","prototype","render","boundRect","update","velocity","vx","screenLocked","setVerticalSpeed","v","setHorizontalSpeed","takeDamage","dmg","hp","isDead","collidesWith","other","otherX","otherY","oxerX","document","querySelector","FPS","lastTime","getTime","curTime","delta","entities","hero","gameLoop","window","requestAnimationFrame","e","filter","registerInputEvents","addEventListener","key","fireProjectile","k","ent","vel","x0","y0","originX","originY","p"],"mappings":"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","file":"main.f9c25091.js","sourceRoot":"..","sourcesContent":["const BG_COLOR = '#333333';\nconst NUM_STARS = 20;\n\nfunction clearCanvas(canvas, ctx) {\n  const { width, height } = canvas;\n  ctx.clearRect(0, 0, width, height);\n\n  setStroke(ctx, '#111111', 0);\n  setFill(ctx, BG_COLOR);\n  rect(ctx, 0, 0, width, height);\n}\n\nfunction buildStars(width, height) {\n  const starField = [];\n  for (let i = 0; i < NUM_STARS; i++) {\n    let star = {\n      x: Math.floor(Math.random() * (width - 1)),\n      y: Math.floor(Math.random() * (height - 1)),\n      vy: Math.ceil(Math.random() * 5)\n    };\n    starField.push(star);\n  }\n  return starField;\n}\n\nfunction updateStarField(canvas, stars) {\n  let ctx = canvas.getContext('2d');\n  stars.forEach(star => {\n    star.y = (star.y + star.vy + canvas.height) % canvas.height;\n    setFill(ctx, '#eee');\n    circle(ctx, star.x, star.y, 3);\n  });\n}\n\nfunction setStroke(ctx, color, width = 1) {\n  ctx.strokeStyle = color;\n  ctx.lineWidth = width;\n}\n\nfunction setFill(ctx, color) {\n  ctx.fillStyle = color;\n}\n\nfunction rect(ctx, x, y, width, height, fill = true) {\n  ctx.beginPath();\n  ctx.rect(x, y, width, height);\n\n  if (fill) {\n    ctx.fill();\n  }\n  ctx.stroke();\n}\n\nfunction circle(ctx, x, y, radius, fill = true) {\n  ctx.beginPath();\n  ctx.arc(x, y, radius, 0, 2 * Math.PI);\n  if (fill) {\n    ctx.fill();\n  }\n  ctx.stroke();\n  ctx.closePath;\n}\n\nfunction image(ctx, src, x, y, w, h) {\n  ctx.drawImage(src, x, y, w, h);\n}\n\nfunction triangle(ctx, x, y, w, h) {\n  ctx.beginPath();\n  ctx.moveTo(x, y + h);\n  ctx.lineTo(x + w / 2, y);\n  ctx.lineTo(x + w, y + h);\n  ctx.closePath();\n  ctx.fill();\n}\n\nconst Draw = { setStroke, setFill, rect, circle, clearCanvas, image, triangle };\n\nexport { Draw, clearCanvas, buildStars, updateStarField };\n","import { Draw } from './draw.js';\n\nfunction Entity(canvas, ctx, attrs) {\n  this.canvas = canvas;\n  this.ctx = ctx;\n  this.type = '';\n  this.timeCreated = Date.now();\n  this.width = 50;\n  this.height = 50;\n  this.position = [canvas.width / 2, canvas.height / 2];\n\n  if (attrs) {\n    Object.assign(this, attrs);\n  }\n}\n\nEntity.prototype.render = function(boundRect = true) {\n  let [x, y] = this.position;\n  if (boundRect || this.type === 'projectile') {\n    Draw.setStroke(this.ctx, '#eee');\n    Draw.rect(this.ctx, x, y, this.width, this.height, false);\n  }\n\n  if (this.image) {\n    Draw.image(this.image, x, y, this.width, this.height);\n  }\n\n  if (this.type === 'hero') {\n    Draw.setStroke(this.ctx, '#eee');\n    Draw.triangle(this.ctx, x, y, this.width, this.height);\n  } else if (this.type === 'enemy') {\n    // drawEnemyImage\n  } else if (this.type === 'projectile') {\n    Draw.setStroke(this.ctx, 'tomato');\n    Draw.setFill(this.ctx, 'tomato');\n    Draw.circle(this.ctx, this.x, this.y, 10);\n    Draw.rect(this.ctx, x, y, this.width, this.height, true);\n  }\n};\n\nEntity.prototype.update = function() {\n  if (this.velocity) {\n    let [x, y] = this.position;\n    let [vx, vy] = this.velocity;\n\n    if (this.type === 'projectile') {\n    }\n\n    // Clamp speeds here.\n    x += vx;\n    y += vy;\n\n    // Make sure our ship cant go out of bounds\n    if (this.screenLocked) {\n      if (x + this.width >= this.canvas.width) {\n        x = this.canvas.width - this.width - 1;\n      }\n\n      if (x <= 0) x = 1;\n\n      if (y + this.height >= this.canvas.height) {\n        y = this.canvas.height - this.height;\n      }\n\n      if (y <= 0) y = 1;\n    }\n\n    this.position = [x, y];\n    this.velocity = [vx, vy];\n  }\n};\n\nEntity.prototype.setVerticalSpeed = function(v) {\n  this.velocity[1] = v;\n};\n\nEntity.prototype.setHorizontalSpeed = function(v) {\n  this.velocity[0] = v;\n};\n\nEntity.prototype.takeDamage = function(dmg) {\n  if (this.hp) {\n    this.hp = this.hp - dmg;\n  }\n  if (this.hp <= 0) {\n    this.isDead = true;\n  }\n};\n\nEntity.prototype.collidesWith = function(other) {\n  let [x, y] = this.position;\n  let [otherX, otherY] = other.position;\n\n  return (\n    x < oxerX + other.width &&\n    x + this.width > otherX &&\n    y < otherY + other.height &&\n    y + this.height > otherY\n  );\n};\n\nexport { Entity };\n","import { Draw, clearCanvas, buildStars, updateStarField } from './draw.js';\nimport { Entity } from './entity';\n\nconst canvas = document.querySelector('#gameCanvas');\nconst ctx = canvas.getContext('2d');\n\nconst FPS = 1000 / 60;\n\nlet lastTime = new Date().getTime(),\n  curTime = 0,\n  delta = 0;\n\nlet entities = [];\nconst starField = buildStars(canvas.width, canvas.height);\n\nconst hero = new Entity(canvas, ctx, {\n  position: [canvas.width / 2, canvas.height / 2 + 150],\n  velocity: [0, 0],\n  screenLocked: true,\n  type: 'hero'\n});\nentities.push(hero);\n\nregisterInputEvents();\n\nfunction gameLoop() {\n  // Fancy browser animation magic\n  window.requestAnimationFrame(gameLoop);\n\n  curTime = new Date().getTime();\n  delta = curTime - lastTime;\n\n  if (delta > FPS) {\n    clearCanvas(canvas, ctx);\n    update();\n    render();\n  }\n}\ngameLoop();\n\nfunction update() {\n  updateStarField(canvas, starField);\n  // hero.update();\n  entities.forEach(e => e.update());\n\n  // Clear the bodies\n  entities = entities.filter(e => !e.isDead);\n}\n\nfunction render() {\n  // hero.render(false);\n  entities.forEach(e => e.render(false));\n}\n\nfunction registerInputEvents() {\n  document.addEventListener('keydown', e => {\n    if (e.key == 'w' || e.key == 'ArrowUp') {\n      hero.setVerticalSpeed(-5);\n    } else if (e.key == 's' || e.key == 'ArrowDown') {\n      hero.setVerticalSpeed(5);\n    } else if (e.key == 'd' || e.key == 'ArrowRight') {\n      hero.setHorizontalSpeed(5);\n    } else if (e.key == 'a' || e.key == 'ArrowLeft') {\n      hero.setHorizontalSpeed(-5);\n    } else if (e.key == ' ') {\n      fireProjectile(hero, [0, -5]);\n    }\n  });\n\n  document.addEventListener('keyup', e => {\n    const k = e.key;\n    if (k == 'w' || k == 'ArrowUp' || k == 's' || k == 'ArrowDown') {\n      hero.setVerticalSpeed(0);\n    } else if (\n      k == 'd' ||\n      e.key == 'ArrowRight' ||\n      k == 'a' ||\n      k == 'ArrowLeft'\n    ) {\n      hero.setHorizontalSpeed(0);\n    }\n  });\n}\n\nfunction fireProjectile(ent, vel) {\n  let [x0, y0] = ent.position;\n  let originX = x0 + ent.width / 2;\n  let originY = y0 + ent.height / 2;\n\n  let p = new Entity(canvas, ctx, {\n    position: [originX, originY],\n    width: 3,\n    height: 3,\n    velocity: vel,\n    type: 'projectile'\n  });\n\n  entities.push(p);\n}\n"]}